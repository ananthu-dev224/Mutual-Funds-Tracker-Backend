# Mutual Fund Portfolio Backend

A Node.js + Express backend for managing mutual fund portfolios.  
Users can sign up, log in, add mutual funds to their portfolio, track the latest NAVs, view historical performance, and calculate profits/losses.  

---

## üöÄ Features

- **Authentication** with JWT (signup, login, protected routes)  
- **Portfolio Management**  
  - Add funds with purchase details  
  - List current holdings  
  - View total investment, current value, and profit/loss  
  - View historical portfolio performance  
  - Remove funds from portfolio  
- **Funds Module**  
  - Search & paginate mutual funds  
  - Get fund details by scheme code  
  - Get latest NAV (with cache + API fallback)  
- **NAV Caching & Cron Job**  
  - Daily NAV updates saved in MongoDB (`FundLatestNav`, `FundNavHistory`)  
  - Reduces external API calls  
- **Security**  
  - Input validation with `express-validator`  
  - Rate limiting with `express-rate-limit`  
  - Secure headers with `helmet`  
  - Centralized error handling  

---


## üìå Database Schema

1. Users Collection

| Field        | Type     | Description                         |
| ------------ | -------- | ----------------------------------- |
| \_id         | ObjectId | Auto-generated by MongoDB           |
| name         | String   | User's full name                    |
| email        | String   | Unique, lowercase, indexed          |
| passwordHash | String   | Hashed password                     |
| role         | String   | `user` or `admin` (default: `user`) |
| createdAt    | Date     | Auto-generated timestamp            |
| updatedAt    | Date     | Auto-generated timestamp            |

2. Funds Collection

| Field               | Type   | Description                         |
| ------------------- | ------ | ----------------------------------- |
| schemeCode          | Number | Unique code for the fund, indexed   |
| schemeName          | String | Fund name                           |
| isinGrowth          | String | ISIN code for growth option         |
| isinDivReinvestment | String | ISIN code for dividend reinvestment |
| fundHouse           | String | Fund house / AMC name               |
| schemeType          | String | e.g., Equity, Debt                  |
| schemeCategory      | String | e.g., Large Cap, Mid Cap            |
| createdAt           | Date   | Auto-generated timestamp            |
| updatedAt           | Date   | Auto-generated timestamp            |


3. Fund Latest NAV Collection

| Field      | Type   | Description            |
| ---------- | ------ | ---------------------- |
| schemeCode | Number | Unique code, indexed   |
| nav        | Number | Latest NAV value       |
| date       | String | DD-MM-YYYY format      |
| updatedAt  | Date   | Last updated timestamp |


4. Fund NAV History Collection

| Field      | Type   | Description                  |
| ---------- | ------ | ---------------------------- |
| schemeCode | Number | Indexed for queries          |
| nav        | Number | NAV value on the given date  |
| date       | String | DD-MM-YYYY                   |
| createdAt  | Date   | Timestamp of record creation |


5. Portfolio Collection

| Field          | Type     | Description                       |
| -------------- | -------- | --------------------------------- |
| userId         | ObjectId | Reference to `users._id`, indexed |
| schemeCode     | Number   | Indexed                           |
| units          | Number   | Number of units purchased         |
| purchaseDate   | Date     | Date of purchase                  |
| purchaseNav    | Number   | NAV at the time of purchase       |
| investedAmount | Number   | units \* purchaseNav              |
| createdAt      | Date     | Auto-generated timestamp          |
| updatedAt      | Date     | Auto-generated timestamp          |



---

## üìå API Endpoints

üîê Auth

POST /api/auth/signup ‚Üí Register user

POST /api/auth/login ‚Üí Login user & get JWT

üìä Funds

GET /api/funds?search=icici&page=1&limit=10 ‚Üí List/search funds

GET /api/funds/:schemeCode ‚Üí Get fund details

GET /api/funds/:schemeCode/nav ‚Üí Get latest NAV

üíº Portfolio

POST /api/portfolio/add ‚Üí Add fund to portfolio

GET /api/portfolio/list ‚Üí List user portfolio

GET /api/portfolio/value ‚Üí Get current portfolio value & profit/loss

GET /api/portfolio/history?startDate=YYYY-MM-DD&endDate=YYYY-MM-DD ‚Üí Get portfolio historical values

DELETE /api/portfolio/remove/:schemeCode ‚Üí Remove fund from portfolio

---

## POSTMAN API COLLECTION

https://www.postman.com/blue-satellite-762740/mf-portfolio/collection/39dp623/new-collection?action=share&source=copy-link&creator=30758167

Use this link to get the API Collection

---

## ‚öôÔ∏è Setup Instructions And Deploynent Guide


```bash
git clone https://github.com/yourusername/mutualfund-portfolio-backend.git
cd mutualfund-portfolio-backend

npm install

cp .env.example .env

npm run seed:funds

npm start